@model MyWebProfile.Models.Project
@{
    ViewData["Title"] = "Thêm Dự án mới";
    Layout = "_AdminLayout";
}

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <h3 class="mb-4">Thêm Dự án mới</h3>
                
                <form asp-action="CreateProject" method="post">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Title" class="form-label">Tên dự án</label>
                                <input asp-for="Title" class="form-control" placeholder="Nhập tên dự án">
                                <span asp-validation-for="Title" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Price" class="form-label">Giá (USD)</label>
                                <input asp-for="Price" type="number" class="form-control" placeholder="0">
                                <span asp-validation-for="Price" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label asp-for="Description" class="form-label">Mô tả</label>
                        <textarea asp-for="Description" class="form-control" rows="3" placeholder="Mô tả chi tiết về dự án"></textarea>
                        <span asp-validation-for="Description" class="text-danger"></span>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="ImageUrl" class="form-label">URL hình ảnh</label>
                                <input asp-for="ImageUrl" class="form-control" placeholder="https://example.com/image.jpg">
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="GitHubUrl" class="form-label">GitHub URL</label>
                                <input asp-for="GitHubUrl" class="form-control" placeholder="https://github.com/username/repo">
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="DeployUrl" class="form-label">Deploy URL (Tùy chọn)</label>
                                <input asp-for="DeployUrl" class="form-control" placeholder="https://your-app.vercel.app">
                                <small class="form-text text-muted">Link deploy (Vercel, Netlify, Heroku, etc.) - Không bắt buộc</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Tags" class="form-label">Tags (phân cách bằng dấu phẩy)</label>
                                <input asp-for="Tags" class="form-control" placeholder="HTML, CSS, JavaScript">
                                <span asp-validation-for="Tags" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Rating" class="form-label">Đánh giá (1-5)</label>
                                <input asp-for="Rating" type="number" min="1" max="5" step="0.1" class="form-control" placeholder="4.5">
                                <span asp-validation-for="Rating" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Lưu dự án
                        </button>
                        <a href="@Url.Action("Projects", "Admin")" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Quay lại
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h4 class="mb-3">Xem trước Card Dự án</h4>
                <div class="project-preview-container">
                    <div class="project-card-preview" id="projectCardPreview">
                        <div class="project-image">
                            <img id="previewImage" src="/images/default-project.svg" alt="Project Image" class="img-fluid">
                        </div>
                        <div class="project-content">
                            <h5 id="previewTitle" class="project-title">Tên dự án</h5>
                            <p id="previewDescription" class="project-description">Mô tả dự án sẽ hiển thị ở đây...</p>
                            <div class="project-tags">
                                <span id="previewTags" class="badge bg-primary me-1">Tags</span>
                            </div>
                            <div class="project-meta">
                                <span class="price" id="previewPrice">$0</span>
                                <div class="rating" id="previewRating">
                                    <i class="fas fa-star"></i>
                                    <span>0.0</span>
                                </div>
                            </div>
                            <div class="project-actions">
                                <a href="#" class="btn btn-sm btn-outline-primary" id="previewGitHub">
                                    <i class="fab fa-github"></i> GitHub
                                </a>
                                <a href="#" class="btn btn-sm btn-success" id="previewDeploy" style="display: none;">
                                    <i class="fas fa-external-link-alt"></i> Live Demo
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <style>
                .project-preview-container {
                    max-height: 500px;
                    overflow-y: auto;
                }
                
                .project-card-preview {
                    border: 1px solid #e0e0e0;
                    border-radius: 12px;
                    overflow: hidden;
                    background: white;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                    transition: transform 0.2s ease, box-shadow 0.2s ease;
                }
                
                .project-card-preview:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
                }
                
                .project-image {
                    height: 200px;
                    overflow: hidden;
                    background: #f8f9fa;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                
                .project-image img {
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                }
                
                .project-content {
                    padding: 1.5rem;
                }
                
                .project-title {
                    font-size: 1.25rem;
                    font-weight: 600;
                    margin-bottom: 0.75rem;
                    color: #2c3e50;
                }
                
                .project-description {
                    color: #6c757d;
                    font-size: 0.9rem;
                    line-height: 1.5;
                    margin-bottom: 1rem;
                    display: -webkit-box;
                    -webkit-line-clamp: 3;
                    -webkit-box-orient: vertical;
                    overflow: hidden;
                }
                
                .project-tags {
                    margin-bottom: 1rem;
                }
                
                .project-tags .badge {
                    font-size: 0.75rem;
                    padding: 0.25rem 0.5rem;
                }
                
                .project-meta {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 1rem;
                    padding: 0.75rem 0;
                    border-top: 1px solid #e9ecef;
                    border-bottom: 1px solid #e9ecef;
                }
                
                .price {
                    font-weight: 600;
                    color: #28a745;
                    font-size: 1.1rem;
                }
                
                .rating {
                    display: flex;
                    align-items: center;
                    gap: 0.25rem;
                    color: #ffc107;
                }
                
                .rating i {
                    font-size: 0.9rem;
                }
                
                .project-actions {
                    display: flex;
                    gap: 0.5rem;
                }
                
                .project-actions .btn {
                    font-size: 0.8rem;
                    padding: 0.375rem 0.75rem;
                }
                </style>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get form elements
    const titleInput = document.getElementById('Title');
    const descriptionInput = document.getElementById('Description');
    const imageUrlInput = document.getElementById('ImageUrl');
    const githubUrlInput = document.getElementById('GitHubUrl');
    const deployUrlInput = document.getElementById('DeployUrl');
    const tagsInput = document.getElementById('Tags');
    const priceInput = document.getElementById('Price');
    const ratingInput = document.getElementById('Rating');
    
    // Get preview elements
    const previewTitle = document.getElementById('previewTitle');
    const previewDescription = document.getElementById('previewDescription');
    const previewImage = document.getElementById('previewImage');
    const previewGitHub = document.getElementById('previewGitHub');
    const previewDeploy = document.getElementById('previewDeploy');
    const previewTags = document.getElementById('previewTags');
    const previewPrice = document.getElementById('previewPrice');
    const previewRating = document.getElementById('previewRating');
    
    // Update preview when form inputs change
    function updatePreview() {
        // Update title
        previewTitle.textContent = titleInput.value || 'Tên dự án';
        
        // Update description
        previewDescription.textContent = descriptionInput.value || 'Mô tả dự án sẽ hiển thị ở đây...';
        
        // Update image
        if (imageUrlInput.value) {
            previewImage.src = imageUrlInput.value;
            previewImage.style.display = 'block';
        } else {
            previewImage.src = '/images/default-project.svg';
        }
        
        // Update GitHub link
        if (githubUrlInput.value) {
            previewGitHub.href = githubUrlInput.value;
            previewGitHub.style.display = 'inline-block';
        } else {
            previewGitHub.style.display = 'none';
        }
        
        // Update Deploy link
        if (deployUrlInput.value) {
            if (previewDeploy) {
                previewDeploy.href = deployUrlInput.value;
                previewDeploy.style.display = 'inline-block';
            } else {
                // Create Deploy link if it doesn't exist
                const actionsDiv = document.querySelector('.project-actions');
                if (actionsDiv) {
                    actionsDiv.innerHTML += `
                        <a href="${deployUrlInput.value}" class="btn btn-sm btn-success" id="previewDeploy" target="_blank">
                            <i class="fas fa-external-link-alt"></i> Live Demo
                        </a>
                    `;
                }
            }
        } else if (previewDeploy) {
            previewDeploy.style.display = 'none';
        }
        
                 // Update tags
         if (previewTags) {
             if (tagsInput.value) {
                 const tags = tagsInput.value.split(',').map(tag => tag.trim());
                 previewTags.innerHTML = tags.map(tag => 
                     `<span class="badge bg-primary me-1">${tag}</span>`
                 ).join('');
             } else {
                 previewTags.innerHTML = '<span class="badge bg-primary me-1">Tags</span>';
             }
         }
        
        // Update price
        if (priceInput.value) {
            previewPrice.textContent = `$${parseFloat(priceInput.value).toLocaleString()}`;
        } else {
            previewPrice.textContent = '$0';
        }
        
        // Update rating
        if (ratingInput.value) {
            const rating = parseFloat(ratingInput.value);
            previewRating.innerHTML = `
                <i class="fas fa-star"></i>
                <span>${rating.toFixed(1)}</span>
            `;
        } else {
            previewRating.innerHTML = `
                <i class="fas fa-star"></i>
                <span>0.0</span>
            `;
        }
    }
    
    // Add event listeners to form inputs
    titleInput.addEventListener('input', updatePreview);
    descriptionInput.addEventListener('input', updatePreview);
    imageUrlInput.addEventListener('input', updatePreview);
    githubUrlInput.addEventListener('input', updatePreview);
    deployUrlInput.addEventListener('input', updatePreview);
    tagsInput.addEventListener('input', updatePreview);
    priceInput.addEventListener('input', updatePreview);
    ratingInput.addEventListener('input', updatePreview);
    
    // Initial preview update
    updatePreview();
});
</script> 