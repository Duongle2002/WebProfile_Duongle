@model MyWebProfile.Models.Project
@{
    ViewData["Title"] = "Thêm Dự án mới";
    Layout = "_AdminLayout";
}

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <h3 class="mb-4">Thêm Dự án mới</h3>
                
                <form asp-action="CreateProject" method="post">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Title" class="form-label">Tên dự án</label>
                                <input asp-for="Title" class="form-control" placeholder="Nhập tên dự án">
                                <span asp-validation-for="Title" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Price" class="form-label">Giá (USD)</label>
                                <input asp-for="Price" type="number" class="form-control" placeholder="0">
                                <span asp-validation-for="Price" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label asp-for="Description" class="form-label">Mô tả</label>
                        <textarea asp-for="Description" class="form-control" rows="3" placeholder="Mô tả chi tiết về dự án"></textarea>
                        <span asp-validation-for="Description" class="text-danger"></span>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="ImageUrl" class="form-label">URL hình ảnh</label>
                                <input asp-for="ImageUrl" class="form-control" placeholder="https://example.com/image.jpg">
                                <span asp-validation-for="ImageUrl" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="GitHubUrl" class="form-label">GitHub URL</label>
                                <input asp-for="GitHubUrl" class="form-control" placeholder="https://github.com/username/repo">
                                <span asp-validation-for="GitHubUrl" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Tags" class="form-label">Tags (phân cách bằng dấu phẩy)</label>
                                <input asp-for="Tags" class="form-control" placeholder="HTML, CSS, JavaScript">
                                <span asp-validation-for="Tags" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Rating" class="form-label">Đánh giá (1-5)</label>
                                <input asp-for="Rating" type="number" min="1" max="5" step="0.1" class="form-control" placeholder="4.5">
                                <span asp-validation-for="Rating" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Lưu dự án
                        </button>
                        <a href="@Url.Action("Projects", "Admin")" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Quay lại
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h4 class="mb-3">Xem trước Website</h4>
                <div class="preview-frame-container">
                    <iframe id="previewFrame" src="@Url.Action("Index", "Home")" frameborder="0" style="width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 8px;"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const previewFrame = document.getElementById('previewFrame');
    const frameContainer = document.querySelector('.preview-frame-container');
    
    // Show loading indicator when iframe is loading
    previewFrame.addEventListener('load', function() {
        frameContainer.classList.remove('loading');
    });
    
    // Show loading indicator initially
    frameContainer.classList.add('loading');
    
    // Auto-refresh preview every 60 seconds
    setInterval(function() {
        refreshPreview();
    }, 60000);
});

function refreshPreview() {
    const previewFrame = document.getElementById('previewFrame');
    const frameContainer = document.querySelector('.preview-frame-container');
    
    // Show loading indicator
    frameContainer.classList.add('loading');
    
    // Reload the iframe
    previewFrame.src = previewFrame.src;
}

// Handle iframe load events
document.getElementById('previewFrame').addEventListener('load', function() {
    document.querySelector('.preview-frame-container').classList.remove('loading');
});

document.getElementById('previewFrame').addEventListener('error', function() {
    document.querySelector('.preview-frame-container').classList.remove('loading');
});
</script> 