@{
    ViewData["Title"] = "Xem trước Website";
    Layout = "_AdminLayout";
}

<div class="preview-container">
    <div class="preview-header">
        <div class="preview-controls">
            <h3>
                <i class="fas fa-eye"></i>
                Xem trước Website
            </h3>
            <div class="preview-actions">
                <button class="btn btn-primary btn-sm" onclick="refreshPreview()">
                    <i class="fas fa-sync-alt"></i> Làm mới
                </button>
                <a href="@Url.Action("Index", "Home")" target="_blank" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-external-link-alt"></i> Mở trong tab mới
                </a>
                <a href="@Url.Action("Index", "Admin")" class="btn btn-outline-primary btn-sm">
                    <i class="fas fa-arrow-left"></i> Quay lại
                </a>
            </div>
        </div>
    </div>
    
    <div class="preview-frame-container">
        <iframe id="previewFrame" src="@Url.Action("Index", "Home")" frameborder="0"></iframe>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const previewFrame = document.getElementById('previewFrame');
    const frameContainer = document.querySelector('.preview-frame-container');
    
    // Show loading indicator when iframe is loading
    previewFrame.addEventListener('load', function() {
        frameContainer.classList.remove('loading');
    });
    
    // Show loading indicator initially
    frameContainer.classList.add('loading');
    
    // Auto-refresh preview every 30 seconds
    setInterval(function() {
        refreshPreview();
    }, 30000);
});

function refreshPreview() {
    const previewFrame = document.getElementById('previewFrame');
    const frameContainer = document.querySelector('.preview-frame-container');
    
    // Show loading indicator
    frameContainer.classList.add('loading');
    
    // Reload the iframe
    previewFrame.src = previewFrame.src;
}

// Handle iframe load events
document.getElementById('previewFrame').addEventListener('load', function() {
    document.querySelector('.preview-frame-container').classList.remove('loading');
});

document.getElementById('previewFrame').addEventListener('error', function() {
    document.querySelector('.preview-frame-container').classList.remove('loading');
    // Show error message if needed
});
</script> 