@model MyWebProfile.Models.Skill
@{
    ViewData["Title"] = "Chỉnh sửa Kỹ năng";
    Layout = "_AdminLayout";
}

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <h3 class="mb-4">Chỉnh sửa Kỹ năng</h3>
                
                <form asp-action="EditSkill" method="post">
                    <input type="hidden" asp-for="Id" />
                    <input type="hidden" asp-for="CreatedAt" />
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Name" class="form-label">Tên kỹ năng</label>
                                <input asp-for="Name" class="form-control" placeholder="Nhập tên kỹ năng">
                                <span asp-validation-for="Name" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Category" class="form-label">Loại kỹ năng</label>
                                <select asp-for="Category" class="form-control">
                                    <option value="">Chọn loại kỹ năng</option>
                                    <option value="Programming">Lập trình</option>
                                    <option value="Design">Thiết kế</option>
                                    <option value="Database">Cơ sở dữ liệu</option>
                                    <option value="Framework">Framework</option>
                                    <option value="Tool">Công cụ</option>
                                    <option value="Language">Ngôn ngữ</option>
                                    <option value="Other">Khác</option>
                                </select>
                                <span asp-validation-for="Category" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label asp-for="Description" class="form-label">Mô tả</label>
                        <textarea asp-for="Description" class="form-control" rows="3" placeholder="Mô tả chi tiết về kỹ năng"></textarea>
                        <span asp-validation-for="Description" class="text-danger"></span>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Proficiency" class="form-label">Mức độ thành thạo</label>
                                <div class="d-flex align-items-center gap-3">
                                    <input type="range" id="proficiencyRange" class="form-control-range" min="0" max="100" value="@Model.Proficiency">
                                    <span id="proficiencyValue" class="fw-bold">@Model.Proficiency%</span>
                                </div>
                                <input type="hidden" asp-for="Proficiency" id="Proficiency" value="@Model.Proficiency">
                                <span asp-validation-for="Proficiency" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label asp-for="Icon" class="form-label">Icon</label>
                                <div class="input-group">
                                    <input asp-for="Icon" class="form-control" id="iconInput" placeholder="bi-code-slash" value="@Model.Icon">
                                    <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#iconModal">
                                        <i class="bi bi-search"></i> Chọn Icon
                                    </button>
                                </div>
                                <small class="form-text">Sử dụng Bootstrap Icons (ví dụ: bi-code-slash, bi-database)</small>
                                <span asp-validation-for="Icon" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Cập nhật kỹ năng
                        </button>
                        <a href="@Url.Action("Skills", "Admin")" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Quay lại
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h4 class="mb-3">Xem trước</h4>
                <div class="skill-preview">
                    <div class="skill-content">
                        <div class="d-flex align-items-center mb-2">
                            <i id="previewIcon" class="bi bi-code-slash me-2"></i>
                            <h5 id="previewName" class="mb-0">Tên kỹ năng</h5>
                        </div>
                        <div class="skill-meta mb-2">
                            <span class="category" id="previewCategory">Loại kỹ năng</span>
                        </div>
                        <p id="previewDescription" class="skill-description">Mô tả kỹ năng sẽ hiển thị ở đây</p>
                        <div class="skill-progress">
                            <div class="progress">
                                <div id="previewProgress" class="progress-bar" style="width: @Model.Proficiency%"></div>
                            </div>
                            <span id="previewProficiency" class="proficiency-text">@Model.Proficiency%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Icon Selection Modal -->
<div class="modal fade" id="iconModal" tabindex="-1" aria-labelledby="iconModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="iconModalLabel">Chọn Icon</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <input type="text" class="form-control" id="iconSearch" placeholder="Tìm kiếm icon...">
                </div>
                <div class="icon-grid" id="iconGrid">
                    <!-- Icons will be populated by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const nameInput = document.getElementById('Name');
    const categoryInput = document.getElementById('Category');
    const descriptionInput = document.getElementById('Description');
    const proficiencyRange = document.getElementById('proficiencyRange');
    const iconInput = document.getElementById('Icon');

    const previewName = document.getElementById('previewName');
    const previewCategory = document.getElementById('previewCategory');
    const previewDescription = document.getElementById('previewDescription');
    const previewProgress = document.getElementById('previewProgress');
    const previewProficiency = document.getElementById('previewProficiency');
    const previewIcon = document.getElementById('previewIcon');

    function updatePreview() {
        // Update name
        previewName.textContent = nameInput.value || 'Tên kỹ năng';
        
        // Update category
        previewCategory.textContent = categoryInput.value || 'Loại kỹ năng';
        
        // Update description
        previewDescription.textContent = descriptionInput.value || 'Mô tả kỹ năng sẽ hiển thị ở đây';
        
        // Update proficiency
        const proficiency = parseInt(proficiencyRange.value) || 50;
        previewProgress.style.width = proficiency + '%';
        previewProficiency.textContent = proficiency + '%';
        
        // Update icon
        if (iconInput.value) {
            previewIcon.className = iconInput.value + ' me-2';
        } else {
            previewIcon.className = 'bi bi-code-slash me-2';
        }
    }

    // Add event listeners
    nameInput.addEventListener('input', updatePreview);
    categoryInput.addEventListener('change', updatePreview);
    descriptionInput.addEventListener('input', updatePreview);
    proficiencyRange.addEventListener('input', updatePreview);
    iconInput.addEventListener('input', updatePreview);

    // Update proficiency value display
    proficiencyRange.addEventListener('input', function() {
        document.getElementById('proficiencyValue').textContent = this.value + '%';
        document.getElementById('Proficiency').value = this.value;
    });

    // Initial preview
    updatePreview();
    
    // Icon selection functionality
    const iconSearch = document.getElementById('iconSearch');
    const iconGrid = document.getElementById('iconGrid');
    
    // Popular Bootstrap Icons for skills
    const skillIcons = [
        'bi-code-slash', 'bi-braces', 'bi-database', 'bi-gear', 'bi-palette', 'bi-server',
        'bi-code-square', 'bi-terminal', 'bi-cpu', 'bi-motherboard', 'bi-hdd-network',
        'bi-cloud', 'bi-globe', 'bi-wifi', 'bi-router', 'bi-shield-check',
        'bi-lock', 'bi-unlock', 'bi-key', 'bi-tools', 'bi-wrench',
        'bi-hammer', 'bi-screwdriver', 'bi-nut', 'bi-bolt', 'bi-lightning',
        'bi-fire', 'bi-star', 'bi-heart', 'bi-diamond', 'bi-gem',
        'bi-cup-hot', 'bi-cup-straw', 'bi-mug-hot', 'bi-beer', 'bi-wine',
        'bi-cart', 'bi-bag', 'bi-box', 'bi-box-seam', 'bi-boxes',
        'bi-truck', 'bi-car-front', 'bi-bicycle', 'bi-airplane', 'bi-rocket',
        'bi-ship', 'bi-train-front', 'bi-bus-front', 'bi-taxi-front', 'bi-ambulance',
        'bi-hospital', 'bi-heart-pulse', 'bi-activity', 'bi-graph-up', 'bi-graph-down',
        'bi-bar-chart', 'bi-pie-chart', 'bi-diagram-3', 'bi-diagram-2', 'bi-diagram',
        'bi-calendar', 'bi-calendar-check', 'bi-calendar-event', 'bi-calendar-week', 'bi-calendar-month',
        'bi-clock', 'bi-clock-history', 'bi-stopwatch', 'bi-hourglass', 'bi-hourglass-split',
        'bi-alarm', 'bi-bell', 'bi-bell-fill', 'bi-bell-slash', 'bi-bell-slash-fill',
        'bi-envelope', 'bi-envelope-fill', 'bi-envelope-open', 'bi-envelope-open-fill', 'bi-mailbox',
        'bi-telephone', 'bi-telephone-fill', 'bi-telephone-plus', 'bi-telephone-minus', 'bi-telephone-x',
        'bi-phone', 'bi-phone-fill', 'bi-phone-vibrate', 'bi-phone-flip', 'bi-phone-landscape',
        'bi-tablet', 'bi-tablet-landscape', 'bi-laptop', 'bi-laptop-fill', 'bi-display',
        'bi-display-fill', 'bi-monitor', 'bi-tv', 'bi-projector', 'bi-camera',
        'bi-camera-fill', 'bi-camera-video', 'bi-camera-video-fill', 'bi-webcam', 'bi-webcam-fill',
        'bi-mic', 'bi-mic-fill', 'bi-mic-mute', 'bi-mic-mute-fill', 'bi-speaker',
        'bi-speaker-fill', 'bi-speaker-volume', 'bi-speaker-volume-fill', 'bi-headphones', 'bi-headphones-fill',
        'bi-music-note', 'bi-music-note-beamed', 'bi-music-note-list', 'bi-music-player', 'bi-music-player-fill',
        'bi-play', 'bi-play-fill', 'bi-play-circle', 'bi-play-circle-fill', 'bi-pause',
        'bi-pause-fill', 'bi-pause-circle', 'bi-pause-circle-fill', 'bi-stop', 'bi-stop-fill',
        'bi-stop-circle', 'bi-stop-circle-fill', 'bi-skip-backward', 'bi-skip-backward-fill', 'bi-skip-forward',
        'bi-skip-forward-fill', 'bi-arrow-left', 'bi-arrow-right', 'bi-arrow-up', 'bi-arrow-down', 'bi-arrow-up-left',
        'bi-arrow-up-right', 'bi-arrow-down-left', 'bi-arrow-down-right', 'bi-chevron-left', 'bi-chevron-right',
        'bi-chevron-up', 'bi-chevron-down', 'bi-chevron-up-left', 'bi-chevron-up-right', 'bi-chevron-down-left',
        'bi-chevron-down-right', 'bi-caret-left', 'bi-caret-right', 'bi-caret-up', 'bi-caret-down', 'bi-caret-up-left',
        'bi-caret-up-right', 'bi-caret-down-left', 'bi-caret-down-right', 'bi-triangle', 'bi-triangle-fill',
        'bi-square', 'bi-square-fill', 'bi-circle', 'bi-circle-fill', 'bi-hexagon',
        'bi-hexagon-fill', 'bi-octagon', 'bi-octagon-fill', 'bi-diamond', 'bi-diamond-fill',
        'bi-pentagon', 'bi-pentagon-fill', 'bi-star', 'bi-star-fill', 'bi-star-half',
        'bi-heart', 'bi-heart-fill', 'bi-heart-half', 'bi-suit-heart', 'bi-suit-heart-fill',
        'bi-suit-diamond', 'bi-suit-diamond-fill', 'bi-suit-club', 'bi-suit-club-fill', 'bi-suit-spade',
        'bi-suit-spade-fill', 'bi-emoji-smile', 'bi-emoji-smile-fill', 'bi-emoji-frown', 'bi-emoji-frown-fill',
        'bi-emoji-neutral', 'bi-emoji-neutral-fill', 'bi-emoji-dizzy', 'bi-emoji-dizzy-fill', 'bi-emoji-expressionless',
        'bi-emoji-expressionless-fill', 'bi-emoji-angry', 'bi-emoji-angry-fill', 'bi-emoji-laughing', 'bi-emoji-laughing-fill',
        'bi-emoji-wink', 'bi-emoji-wink-fill', 'bi-emoji-kiss', 'bi-emoji-kiss-fill', 'bi-emoji-tear',
        'bi-emoji-tear-fill', 'bi-emoji-sunglasses', 'bi-emoji-sunglasses-fill', 'bi-emoji-smile-upside-down', 'bi-emoji-smile-upside-down-fill'
    ];
    
    function populateIconGrid(filter = '') {
        iconGrid.innerHTML = '';
        const filteredIcons = skillIcons.filter(icon => 
            icon.toLowerCase().includes(filter.toLowerCase())
        );
        
        filteredIcons.forEach(icon => {
            const iconElement = document.createElement('div');
            iconElement.className = 'icon-item';
            iconElement.innerHTML = `
                <div class="icon-preview">
                    <i class="bi ${icon}"></i>
                </div>
                <div class="icon-name">${icon}</div>
            `;
            iconElement.addEventListener('click', () => {
                iconInput.value = icon;
                updatePreview();
                bootstrap.Modal.getInstance(document.getElementById('iconModal')).hide();
            });
            iconGrid.appendChild(iconElement);
        });
    }
    
    // Search functionality
    iconSearch.addEventListener('input', (e) => {
        populateIconGrid(e.target.value);
    });
    
    // Initialize icon grid when modal is shown
    document.getElementById('iconModal').addEventListener('show.bs.modal', () => {
        populateIconGrid();
    });
});
</script>

<style>
.icon-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 1rem;
    max-height: 400px;
    overflow-y: auto;
}

.icon-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
}

.icon-item:hover {
    background-color: #f8f9fa;
    border-color: #007bff;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.1);
}

.icon-preview {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    color: #007bff;
}

.icon-name {
    font-size: 0.8rem;
    color: #6c757d;
    word-break: break-all;
    line-height: 1.2;
}

.skill-preview {
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 1rem;
    background-color: #f8f9fa;
}

.skill-content {
    margin-bottom: 0;
}

.skill-meta {
    font-size: 0.9rem;
    color: #6c757d;
}

.skill-description {
    font-size: 0.9rem;
    color: #495057;
    margin-bottom: 1rem;
}

.skill-progress {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.progress {
    flex: 1;
    height: 8px;
}

.proficiency-text {
    font-size: 0.9rem;
    font-weight: 600;
    color: #007bff;
    min-width: 40px;
}
</style> 